

Installation and upgrade codeunits

Codeunit 
Subtype = Install

trigger OnInstallAppPerCompany
trigger OnInstallAppPerDatabase


Codeunit 
Subtype = Upgrade
(version no. incremented to an higher version to run the cu/ttriggers)

trigger OnUpgradePerCompany
var
Module: ModuleInfo
begin
  NavApp.GetCurrentModuleInfo(Module);
  if Module.DataVersion().Major() = 1 then  -> only run if the Major version is 1
      UpdateSomething();
end;
trigger OnUpgradePerDatabase

Order of the ttriggers (Upgrade Codeunit)
1
OnCheckPreConditionsPerCompany
OnCheckPreConditionsPerDatabase
2
OnUpgradePerCompany
OnUpgradePerDatabase

3
OnValidateUpgradePerCompany
OnValidateUpgradePerDatabase


-----1----2-----3   
 you can control if the user is upgrading from 1 to 3 without passing to 2 (in this case you can raise an error message).


App X contains tables and tables extension
-------------------------------------------------Publish (upload to the server)--------------> install

if you decide to uninstall system will archive the data on your app.

------re-publish---------------------> in that case BC will try to restore the data from the archive ( if there some some schema changes BC could not restore. what you can do is to upgrade code or ForceSync).


Obsolete properties on a field
ObsoleteState ( Pending, Removed)
ObsoleteReason
ObsoleteTag

Microsoft announces (in theory) 2 versions ahead of Removed fields.

There is a repository (Stefan Maron) that keeps track of the code history

Check also DataTransfer for the exam
How can we write code from one table into another table.
Note: It can only used only on UPPGRADE Codeunit 

dt: DataTransfer ( Check the right order to use this )

1 dt.SetTabbles (Database:: FromTablem, Database.ToTable(())
2 dt.AddFieldValue
3 dt.CopyRows

DataTransfer cannot be used on the followont tables
Non-SQL Tables
System Tables
Virtual Tables
Audited tables as the destination
Obsolete tables as the destination

----------------------------------------------
CopyFields if you wnat to join 2 tables
 
dt.SetTables(Database::Source, Database::Destination);
dt.AddFieldBalue
dt.AddSourceFilter
dt.AddJoin 
dt.CopyFields


-----------------


1 Production ( database until 80.00GB - database is compressed)
3 Sandboxes 


----------------------
Detect and aboid breaking changes

When you have one or more applications on AppSource you need to make sure that you don't introduce changes when you release a new version of your app.


Use AppSourceCop to detect breaking changes
 Try ti hude your


Microsoft created overload technique when upgrades versions.
Example:

procedure MyBaseProcedure(MyParameter:: Text[20])
begin
 Message(MyParameter);
end;

procedure MyBaseProcedure(MyParameter:: Text[20]; MyOtherParameter:: Text[20])
begin
 Message(MyParameter + ' ' + MyOtherParameter);
end;

-------------
Exam
Access modifiers are only taken consideration at compile time.

internal - object or field can be accessed only by code in the same module (internval visisible)
local  - the field can be accesse only by the code in the same table or table extension where the field is defined. ( Applies o table fields only)
protected - the field can be accesse only by the code of that table ( Applies o table fields only)
public - The object or field can be accessed by any other code in the same module and in other modules that references it. ( Note This is the default value)

-----------------------------------


Develop 

Table
Properties:
Caption - 
DrillDownPageID - is used on flowfields. when we clicked on the calculated figure it will only display the related page of the Egg Production Line if the DrillDownPageIs is set up.

    field(12; Number of Eggs Produced; Decimal)
    {
        CalcFormula = sum("Egg Production Line". Quantity where .....)
    }

LookupPageI - 
DataClassidfication -
DataCaptionFields - 


App.Json  
"Features" you neenable the tranlsation file - you if you enable you need to repack your solution and it creates a xlf file

if you need to translate file create a copy of the file and change the targe-language and start by editing the <target>
Application to help (i.e - Poedit)

Be aware if you continue add files to your extension the copied files ( for other languages) are not updated automatically
Need to know snippets


















